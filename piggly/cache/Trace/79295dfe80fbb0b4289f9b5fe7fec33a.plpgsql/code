DECLARE
    rcount INTEGER;
BEGIN
    perform public.piggly_branch($PIGGLY$b700a392ff2f3eaa$PIGGLY$);
    BEGIN
        perform public.piggly_branch($PIGGLY$56973453175c6a90$PIGGLY$);
        EXECUTE '
            CREATE TEMP SEQUENCE __tcache___id_seq;
            CREATE TEMP TABLE __tcache__ (
                id    INTEGER NOT NULL DEFAULT nextval(''__tcache___id_seq''),
                label TEXT    NOT NULL,
                value INTEGER NOT NULL,
                note  TEXT    NOT NULL DEFAULT ''''
            );
            CREATE UNIQUE INDEX __tcache___key ON __tcache__(id);
            GRANT ALL ON TABLE __tcache__ TO PUBLIC;
            GRANT ALL ON TABLE __tcache___id_seq TO PUBLIC;

            CREATE TEMP SEQUENCE __tresults___numb_seq;
            GRANT ALL ON TABLE __tresults___numb_seq TO PUBLIC;
        ';

    EXCEPTION WHEN duplicate_table THEN
        -- Raise an exception if there's already a plan.
        perform public.piggly_branch($PIGGLY$0915dde92957e60b$PIGGLY$);
        EXECUTE 'SELECT TRUE FROM __tcache__ WHERE label = ''plan''';
      GET DIAGNOSTICS rcount = ROW_COUNT;
        IF public.piggly_cond($PIGGLY$3dea51e6cc522106$PIGGLY$, (rcount > 0)) THEN
           perform public.piggly_branch($PIGGLY$22ace06e54aae582$PIGGLY$);
           perform public.piggly_branch($PIGGLY$4c9e7c2f527cfac2$PIGGLY$);RAISE EXCEPTION 'You tried to plan twice!';
        END IF;
    END;

    -- Save the plan and return.
    PERFORM _set('plan', $1 );
    PERFORM _set('failed', 0 );
    perform public.piggly_branch($PIGGLY$b88bc138873870dc$PIGGLY$);RETURN '1..' || $1;
END;