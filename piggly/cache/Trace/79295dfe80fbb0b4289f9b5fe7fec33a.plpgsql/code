DECLARE
    rcount INTEGER;
BEGIN
    perform public.piggly_branch($PIGGLY$c905fc6aad60f0f1$PIGGLY$);
    BEGIN
        perform public.piggly_branch($PIGGLY$9c8066cd94c8fd22$PIGGLY$);
        EXECUTE '
            CREATE TEMP SEQUENCE __tcache___id_seq;
            CREATE TEMP TABLE __tcache__ (
                id    INTEGER NOT NULL DEFAULT nextval(''__tcache___id_seq''),
                label TEXT    NOT NULL,
                value INTEGER NOT NULL,
                note  TEXT    NOT NULL DEFAULT ''''
            );
            CREATE UNIQUE INDEX __tcache___key ON __tcache__(id);
            GRANT ALL ON TABLE __tcache__ TO PUBLIC;
            GRANT ALL ON TABLE __tcache___id_seq TO PUBLIC;

            CREATE TEMP SEQUENCE __tresults___numb_seq;
            GRANT ALL ON TABLE __tresults___numb_seq TO PUBLIC;
        ';

    EXCEPTION WHEN duplicate_table THEN
        -- Raise an exception if there's already a plan.
        perform public.piggly_branch($PIGGLY$8ff1bec175c64dd7$PIGGLY$);
        EXECUTE 'SELECT TRUE FROM __tcache__ WHERE label = ''plan''';
      GET DIAGNOSTICS rcount = ROW_COUNT;
        IF public.piggly_cond($PIGGLY$0403d8a5fcb844e6$PIGGLY$, (rcount > 0)) THEN
           perform public.piggly_branch($PIGGLY$87fb6ca59cc0cd5f$PIGGLY$);
           perform public.piggly_branch($PIGGLY$b6b6943b76e2abb4$PIGGLY$);RAISE EXCEPTION 'You tried to plan twice!';
        END IF;
    END;

    -- Save the plan and return.
    PERFORM _set('plan', $1 );
    PERFORM _set('failed', 0 );
    perform public.piggly_branch($PIGGLY$03ad38f414965c60$PIGGLY$);RETURN '1..' || $1;
END;