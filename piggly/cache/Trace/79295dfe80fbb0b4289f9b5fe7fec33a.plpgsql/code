DECLARE
    rcount INTEGER;
BEGIN
    perform public.piggly_branch($PIGGLY$8cae5a42961f8db5$PIGGLY$);
    BEGIN
        perform public.piggly_branch($PIGGLY$6acb141a6b5bd982$PIGGLY$);
        EXECUTE '
            CREATE TEMP SEQUENCE __tcache___id_seq;
            CREATE TEMP TABLE __tcache__ (
                id    INTEGER NOT NULL DEFAULT nextval(''__tcache___id_seq''),
                label TEXT    NOT NULL,
                value INTEGER NOT NULL,
                note  TEXT    NOT NULL DEFAULT ''''
            );
            CREATE UNIQUE INDEX __tcache___key ON __tcache__(id);
            GRANT ALL ON TABLE __tcache__ TO PUBLIC;
            GRANT ALL ON TABLE __tcache___id_seq TO PUBLIC;

            CREATE TEMP SEQUENCE __tresults___numb_seq;
            GRANT ALL ON TABLE __tresults___numb_seq TO PUBLIC;
        ';

    EXCEPTION WHEN duplicate_table THEN
        -- Raise an exception if there's already a plan.
        perform public.piggly_branch($PIGGLY$9dcabda3024bb622$PIGGLY$);
        EXECUTE 'SELECT TRUE FROM __tcache__ WHERE label = ''plan''';
      GET DIAGNOSTICS rcount = ROW_COUNT;
        IF public.piggly_cond($PIGGLY$4c8d6cbce9ce073d$PIGGLY$, (rcount > 0)) THEN
           perform public.piggly_branch($PIGGLY$563541799173b296$PIGGLY$);
           perform public.piggly_branch($PIGGLY$066488ac9d0ad297$PIGGLY$);RAISE EXCEPTION 'You tried to plan twice!';
        END IF;
    END;

    -- Save the plan and return.
    PERFORM _set('plan', $1 );
    PERFORM _set('failed', 0 );
    perform public.piggly_branch($PIGGLY$10df164951341c67$PIGGLY$);RETURN '1..' || $1;
END;